// Required
var fs = require("fs");

// Custom modules
module.exports = {

    // Get Format Funciton
    send_response: function send_response(request, response, data) {

        // Set response header to allow CORS
        response.header("Access-Control-Allow-Origin", "*");

        // If JSON, return json object
        if (request.params.style === 'json'){

            // Send response
            response.json(data);

        }
        // Else, return requested data obj
        else {

            // If color parameter exists
            if (request.query.fill){
                // Take data string and add fill style to all <paths>
                data = data.replace(/<path/g, '<path style="fill:#' + request.query.fill + '"');
            }

            // Set response header to img/svg
            response.header('Content-Type', 'image/svg+xml');
            // Send response
            response.send(data);

        }
    },

    // Read file, using Async and Callback for status
    read_file: function read_file(file, callback) {

        // Check if file exists
        fs.exists(file.path, function(exists){

            // If it does, read it
            if (exists){
                fs.readFile(file.path, 'utf8', callback);
            } else {
                callback();
            }

        });

    },

    // Return not-found
    not_found_icon: function not_found_icon(){
        return '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500 500"><path d="M421.875,31.25H78.125c-25.879,0-46.875,20.996-46.875,46.875v343.75c0,25.879,20.996,46.875,46.875,46.875h343.75 c25.879,0,46.875-20.996,46.875-46.875V78.125C468.75,52.246,447.754,31.25,421.875,31.25z M168.855,164.716h15.434l24.266,42.25 l0.273-0.091v-42.158h15.342v66.288h-15.342l-24.266-42.249l-0.273,0.091v42.158h-15.434V164.716z M153.516,266.554H122.33v15.935 h26.542v11.837H122.33v26.679h-15.434v-66.287h46.62V266.554z M212.891,293.824c0,8.165-2.588,14.895-7.763,20.191 c-5.175,5.297-11.936,7.944-20.282,7.944c-8.408,0-15.222-2.647-20.441-7.944c-5.221-5.297-7.831-12.026-7.831-20.191v-11.928 c0-8.134,2.603-14.857,7.808-20.169c5.205-5.312,11.997-7.968,20.374-7.968c8.315,0,15.084,2.656,20.305,7.968 c5.22,5.312,7.831,12.035,7.831,20.169V293.824z M274.652,298.149c0,7.558-2.512,13.415-7.535,17.573 c-5.023,4.159-11.602,6.237-19.735,6.237c-8.226,0-14.857-2.078-19.896-6.237c-5.039-4.158-7.557-10.016-7.557-17.573v-43.433 h15.434v43.433c0,4.067,1.047,7.079,3.141,9.037s5.054,2.937,8.878,2.937c3.794,0,6.716-0.971,8.765-2.914 c2.048-1.941,3.072-4.963,3.072-9.06v-43.433h15.434V298.149z M259.949,231.96c-8.408,0-15.222-2.647-20.441-7.944 c-5.221-5.296-7.831-12.026-7.831-20.191v-11.928c0-8.133,2.603-14.856,7.808-20.168c5.205-5.311,11.997-7.967,20.374-7.967 c8.315,0,15.084,2.656,20.305,7.967c5.22,5.312,7.831,12.035,7.831,20.168v11.928c0,8.165-2.588,14.895-7.763,20.191 C275.057,229.312,268.295,231.96,259.949,231.96z M339.021,321.004H323.68l-24.267-42.249l-0.273,0.091v42.158h-15.434v-66.287 h15.434l24.267,42.249l0.273-0.091v-42.158h15.342V321.004z M341.084,176.554h-17.482v54.45h-15.434v-54.45h-17.346v-11.837h50.262 V176.554z M399.766,293.824c0,7.982-2.626,14.508-7.877,19.576c-5.25,5.069-11.775,7.604-19.576,7.604h-23.947v-66.287h23.947 c7.801,0,14.326,2.542,19.576,7.625c5.251,5.084,7.877,11.603,7.877,19.555V293.824z M184.755,265.598c-4.159,0-7.338,1.51-9.538,4.529c-2.201,3.021-3.301,6.914-3.301,11.678v12.02 c0,4.796,1.115,8.711,3.346,11.746s5.425,4.553,9.583,4.553c4.036,0,7.163-1.518,9.378-4.553c2.215-3.035,3.324-6.95,3.324-11.746 v-12.02c0-4.734-1.115-8.619-3.346-11.654S188.822,265.598,184.755,265.598z M259.858,175.598c-4.159,0-7.338,1.51-9.538,4.53c-2.201,3.021-3.301,6.913-3.301,11.678v12.019 c0,4.796,1.115,8.711,3.346,11.746c2.231,3.035,5.426,4.553,9.584,4.553c4.036,0,7.162-1.518,9.379-4.553 c2.215-3.035,3.323-6.95,3.323-11.746v-12.019c0-4.735-1.115-8.62-3.347-11.655C267.074,177.116,263.925,175.598,259.858,175.598z M371.266,266.554h-7.467v42.613h7.467c4.098,0,7.299-1.403,9.605-4.212c2.307-2.807,3.461-6.518,3.461-11.131v-12.02 c0-4.582-1.154-8.27-3.461-11.062S375.363,266.554,371.266,266.554z"/></svg>';
    }
};
